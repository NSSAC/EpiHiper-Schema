{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Type dictionary for EpiHiper JSON schemas.",
  "description": "This schema contains all necessary types used in EpiHiper schemas.",
  "definitions": {
    "uniqueId": {
      "$id": "#uniqueId",
      "description": "An Id which has to be unique within the containing array.",
      "type": "string",
      "pattern": "^(_|[0-9]|[a-z]|[A-Z])+$"
    },
    "uniqueIdRef": {
      "$id": "#uniqueIdRef",
      "description": "An Id which references a existing unique Id.",
      "type": "string",
      "pattern": "^(_|[0-9]|[a-z]|[A-Z])+$"
    },
    "label": {
      "$id": "#label",
      "description": "A human readable label used for user interfaces and reporting. ",
      "type": "string",
      "pattern": "^\\S+(\\W+\\S+)*$"
    },
    "nonNegativeNumber": {
      "$id": "#nonNegativeNumber",
      "description": "A non negative number, i.e., 0 <= x",
      "type": "number",
      "minimum": 0
    },
    "nonNegativeInteger": {
      "$id": "#nonNegativeInteger",
      "description": "A non negative interger l, i.e., 0 <= l",
      "allOf": [
        {"$ref": "#/definitions/nonNegativeNumber"},
        {"multipleOf": 1}
      ]
    },
    "number": {
      "$id": "#number",
      "description": "A number property with a non negative value.",
      "type": "object",
      "required": ["number"],
      "properties": {
        "number": {"$ref": "#/definitions/nonNegativeNumber"}
      }
    },
    "traitEnum": {
      "$id": "#traitEnum",
      "description": "An enumeration value of feature of traits (node traits or edge traits).",
      "type": "object",
      "required": [
        "trait",
        "feature",
        "enum"
      ],
      "properties": {
        "trait": {
          "description": "",
          "$ref": "#/definitions/uniqueIdRef"
        },
        "feature": {
          "description": "",
          "$ref": "#/definitions/uniqueIdRef"
        },
        "enum": {
          "description": "",
          "$ref": "#/definitions/uniqueIdRef"
        }
      }
    },
    "annotation": {
      "type": "object",
      "properties": {
        "ann:id": {"$ref": "#/definitions/uniqueIdRef"},
        "ann:label": {"$ref": "#/definitions/label"},
        "ann:description": {
          "description": "A detailed description of the object using markdown.",
          "type": "string"
        }
      }
    },
    "numericOperation": {
      "$id": "#numericOperation",
      "description": "A numeric operation apllicable to edge waits, susceptibilityFactors, and  infectivityFactors.",
      "type": "object",
      "required": [
        "operator",
        "value"
      ],
      "properties": {
        "operator": {
          "type": "string",
          "enum": [
            "=",
            "*=",
            "/="
          ]
        },
        "value": {"$ref": "#/definitions/nonNegativeNumber"}
      }
    },
    "distribution": {
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "type": "object",
          "description": "Specify distributions for sampling values.",
          "$comment": "Note: The result may require rounding if necessary.",
          "oneOf": [
            {
              "required": ["fixed"]
            },
            {
              "required": ["discrete"]
            },
            {
              "required": ["uniform"]
            },
            {
              "required": ["normal"]
            }
          ],
          "properties": {
            "fixed": {"$ref": "#/definitions/nonNegativeNumber"}
          },
          "discrete": {
            "description": "A number is sampled from the array with each number having the same propability.",
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "probability",
                "value"
              ],
              "properties": {
                "probability": {
                  "allOf": [
                    {"$ref": "#/definitions/nonNegativeNumber"},
                    {"maximum": 1}
                  ]
                },
                "value": {"$ref": "#/definitions/nonNegativeNumber"}
              }
            }
          },
          "uniform": {
            "oneOf": [
              {
                "type": "object",
                "description": "A number is sampled uniformly from the given values",
                "required": ["values"],
                "properties": {
                  "values": {
                    "type": "array",
                    "items": {"$ref": "#/definitions/nonNegativeNumber"}
                  }
                }
              },
              {
                "type": "object",
                "description": "A number is sampled uniformly in the given intervall [min, max]",
                "required": [
                  "min",
                  "max"
                ],
                "properties": {
                  "min": {"$ref": "#/definitions/nonNegativeNumber"},
                  "max": {"$ref": "#/definitions/nonNegativeNumber"}
                }
              }
            ]
          },
          "normal": {
            "type": "object",
            "description": "A number is sampled from a normal or Gaussian distribution.",
            "required": [
              "mean",
              "standardDeviation"
            ],
            "properties": {
              "mean": {"$ref": "#/definitions/nonNegativeNumber"},
              "standardDeviation": {"$ref": "#/definitions/nonNegativeNumber"}
            }
          }
        }
      ]
    },
    "healthState": {
      "$id": "#healthState",
      "description": "A value referrencing a state within the disease model.",
      "type": "object",
      "required": ["healthState"],
      "properties": {
        "healthState": {"$ref": "#/definitions/uniqueIdRef"}
      }
    },
    "value": {
      "$id": "#value",
      "description": "A value used in comparisons and assignments.",
      "type": "object",
      "required": ["value"],
      "properties": {
        "value": {
          "oneOf": [
            {
              "description": "A boolean property.",
              "type": "object",
              "required": ["boolean"],
              "properties": {
                "boolean": {"type": "boolean"}
              }
            },
            {"$ref": "#/definitions/number"},
            {"$ref": "#/definitions/healthState"},
            {"$ref": "#/definitions/traitEnum"}
          ]
        }
      }
    },
    "valueList": {
      "$id": "#valueList",
      "description": "A list of values used in comparisons and assignments.",
      "type": "object",
      "required": ["valueList"],
      "properties": {
        "valueList": {
          "oneOf": [
            {
              "type": "object",
              "required": ["boolean"],
              "properties": {
                "boolean": {
                  "type": "array",
                  "items": {"type": "boolean"}
                }
              }
            },
            {
              "type": "object",
              "required": ["number"],
              "properties": {
                "number": {
                  "type": "array",
                  "items": {"$ref": "#/definitions/nonNegativeNumber"}
                }
              }
            },
            {
              "type": "object",
              "required": ["healthState"],
              "properties": {
                "healthState": {
                  "type": "array",
                  "items": {"$ref": "#/definitions/uniqueIdRef"}
                }
              }
            },
            {
              "type": "object",
              "required": [
                "trait",
                "feature",
                "enum"
              ],
              "properties": {
                "trait": {
                  "description": "",
                  "$ref": "#/definitions/uniqueIdRef"
                },
                "feature": {
                  "description": "",
                  "$ref": "#/definitions/uniqueIdRef"
                },
                "enum": {
                  "type": "array",
                  "items": {"$ref": "#/definitions/uniqueIdRef"}
                }
              }
            }
          ]
        }
      }
    },
    "observable": {
      "$id": "#observable",
      "description": "An observable which is always accessible within EpiHiper (time and health state statistics) of the current state of the system.",
      "type": "object",
      "required": ["observable"],
      "properties": {
        "observable": {
          "oneOf": [
            {
              "type": "object",
              "required": [
                "healthState",
                "type"
              ],
              "properties": {
                "healthState": {"$ref": "#/definitions/uniqueIdRef"},
                "type": {
                  "type": "string",
                  "enum": [
                    "absolute",
                    "relative"
                  ]
                }
              }
            },
            {
              "description": "The time property references the current simulation time.",
              "type": "string",
              "enum": ["time"]
            }
          ]
        }
      }
    },
    "dbField": {
      "$id": "#dbField",
      "description": " A field in a table in the external person trait database.",
      "type": "object",
      "required": [
        "table",
        "field"
      ],
      "properties": {
        "table": {"$ref": "#/definitions/uniqueIdRef"},
        "field": {"$ref": "#/definitions/uniqueIdRef"}
      }
    },
    "dbFieldValue": {
      "$id": "#dbFieldValue",
      "description": "A value for comparisons with field values in the external person trait database.",
      "type": "object",
      "required": ["value"],
      "properties": {
        "value": {
          "oneOf": [
            {"type": "number"},
            {"type": "string"}
          ]
        }
      }
    },
    "dbFieldValueList": {
      "$id": "#dbFieldValueList",
      "description": "A list of value for comparisons with field values in the external person trait database.",
      "type": "object",
      "required": ["valueList"],
      "properties": {
        "valueList": {
          "oneOf": [
            {
              "type": "array",
              "items": {"type": "number"}
            },
            {
              "type": "array",
              "items": {"type": "string"}
            }
          ]
        }
      }
    },
    "dbFieldValueSelector": {
      "$id": "#dbFieldValueSelector",
      "description": "A filter returning a list dbFieldValues from the external person trait database.",
      "type": "object",
      "required": [
        "elementType",
        "table",
        "field",
        "selector"
      ],
      "properties": {
        "elementType": {
          "type": "string",
          "enum": ["dbField"]
        },
        "table": {"$ref": "#/definitions/uniqueIdRef"},
        "field": {"$ref": "#/definitions/uniqueIdRef"},
        "selector": {"$ref": "#/definitions/setContent"}
      }
    },
    "nodeProperty": {
      "$id": "#nodeProperty",
      "description": "A property of a node.",
      "oneOf": [
        {
          "description": "The node properties: id, susceptibilityFactor, infectivityFactor, and healthState",
          "type": "object",
          "required": ["property"],
          "properties": {
            "property": {
              "type": "string",
              "enum": [
                "id",
                "susceptibilityFactor",
                "infectivityFactor",
                "healthState"
              ]
            }
          }
        },
        {
          "description": "A feature of the node property nodeTrait",
          "type": "object",
          "required": [
            "property",
            "feature"
          ],
          "properties": {
            "property": {
              "type": "string",
              "enum": ["nodeTrait"]
            },
            "feature": {"$ref": "#/definitions/uniqueIdRef"}
          }
        }
      ]
    },
    "edgeProperty": {
      "$id": "#edgeProperty",
      "description": "A property of an edge.",
      "oneOf": [
        {
          "description": "The edge properties: weight and active",
          "type": "object",
          "required": ["property"],
          "properties": {
            "property": {
              "type": "string",
              "enum": [
                "weight",
                "active"
              ]
            }
          }
        },
        {
          "description": "A feature of the edge properties: targetTrait and sourceTrait",
          "type": "object",
          "required": [
            "property",
            "feature"
          ],
          "properties": {
            "property": {
              "type": "string",
              "enum": [
                "targetTrait",
                "sourceTrait",
                "edgeTrait"
              ]
            },
            "feature": {"$ref": "#/definitions/uniqueIdRef"}
          }
        },
        {
          "description": "A target node property",
          "type": "object",
          "required": ["targetNode"],
          "properties": {
            "targetNode": {"$ref": "#/definitions/nodeProperty"}
          }
        },
        {
          "description": "A source node property",
          "type": "object",
          "required": ["sourceNode"],
          "properties": {
            "targetNode": {"$ref": "#/definitions/nodeProperty"}
          }
        }
      ]
    },
    "globalVariable": {
      "$id": "#globalVariable",
      "description": "A global variable",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "type": "object",
          "required": ["id"],
          "properties": {
            "id": {"$ref": "#/definitions/uniqueId"},
            "initialValue": {"$ref": "#/definitions/nonNegativeInteger"},
            "reset": {"$ref": "#/definitions/nonNegativeInteger"},
            "selector": {"$ref": "#/definitions/setContent"}
          },
          "patternProperties": {
            "^ann:": {}
          },
          "additionalProperties": false
        }
      ]
    },
    "globalVariables": {
      "$id": "#globalVariables",
      "description": "A list of global variables",
      "type": "array",
      "items": {"$ref": "#/definitions/globalVariable"}
    },
    "globalVariableReference": {
      "$id": "#globalVariableReference",
      "description": "A global variable reference.",
      "type": "object",
      "required": ["globalVariable"],
      "properties": {
        "globalVariable": {
          "type": "object",
          "required": ["idRef"],
          "properties": {
            "idRef": {"$ref": "#/definitions/uniqueIdRef"}
          }
        }
      }
    },
    "sizeof": {
      "$id": "#sizeof",
      "description": "The count of the elements in a set.",
      "type": "object",
      "required": ["sizeof"],
      "properties": {
        "sizeof": {"$ref": "#/definitions/setContent"}
      }
    },
    "boolean": {
      "$id": "#boolean",
      "description": "A boolean value.",
      "type": "object",
      "oneOf": [
        {"type": "boolean"},
        {"$ref": "#/definitions/booleanNot"},
        {"$ref": "#/definitions/booleanOperation"},
        {"$ref": "#/definitions/condition"}
      ]
    },
    "booleanNot": {
      "$id": "#booleanNot",
      "description": "Negates the boolean value",
      "type": "object",
      "required": ["not"],
      "properties": {
        "not": {"$ref": "#/definitions/boolean"}
      }
    },
    "booleanOperation": {
      "$id": "#booleanOperation",
      "description": "A Boolean operation applied to multiple Boolean values which can be 'and' or 'or'.",
      "type": "object",
      "oneOf": [
        {
          "required": ["and"],
          "properties": {
            "and": {
              "type": "array",
              "items": {"$ref": "#/definitions/boolean"}
            }
          },
          "additionalProperties": false
        },
        {
          "required": ["or"],
          "properties": {
            "or": {
              "type": "array",
              "items": {"$ref": "#/definitions/boolean"}
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "comparisonOperator": {
      "$id": "#comparisonOperator",
      "description": "Comparison operators",
      "type": "string",
      "enum": [
        "==",
        "!=",
        "<=",
        "<",
        ">=",
        ">"
      ]
    },
    "condition": {
      "$id": "#condition",
      "description": "A condition used in evaluating triggers and action conditions.",
      "oneOf": [
        {
          "type": "object",
          "required": [
            "operator",
            "left",
            "right"
          ],
          "properties": {
            "operator": {"$ref": "#/definitions/comparisonOperator"},
            "left": {
              "type": "object",
              "description": "",
              "oneOf": [
                {"$ref": "#/definitions/value"},
                {"$ref": "#/definitions/observable"},
                {
                  "type": "object",
                  "required": ["node"],
                  "properties": {
                    "node": {"$ref": "#/definitions/nodeProperty"}
                  }
                },
                {
                  "type": "object",
                  "required": ["edge"],
                  "properties": {
                    "edge": {"$ref": "#/definitions/edgeProperty"}
                  }
                },
                {"$ref": "#/definitions/globalVariableReference"},
                {"$ref": "#/definitions/sizeof"}
              ]
            },
            "right": {
              "type": "object",
              "description": "",
              "oneOf": [
                {"$ref": "#/definitions/value"},
                {"$ref": "#/definitions/observable"},
                {
                  "type": "object",
                  "required": ["node"],
                  "properties": {
                    "node": {"$ref": "#/definitions/nodeProperty"}
                  }
                },
                {
                  "type": "object",
                  "required": ["edge"],
                  "properties": {
                    "edge": {"$ref": "#/definitions/edgeProperty"}
                  }
                },
                {"$ref": "#/definitions/globalVariableReference"},
                {"$ref": "#/definitions/sizeof"}
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "operator",
            "left",
            "right"
          ],
          "properties": {
            "operator": {
              "description": "",
              "type": "string",
              "enum": [
                "in",
                "not in"
              ]
            },
            "left": {
              "type": "object",
              "description": "",
              "oneOf": [
                {
                  "type": "object",
                  "required": ["node"],
                  "properties": {
                    "node": {"$ref": "#/definitions/nodeProperty"}
                  }
                },
                {
                  "type": "object",
                  "required": ["edge"],
                  "properties": {
                    "edge": {"$ref": "#/definitions/edgeProperty"}
                  }
                }
              ]
            },
            "right": {"$ref": "#/definitions/valueList"}
          }
        }
      ]
    },
    "action": {
      "$id": "#action",
      "description": "An action to be executed.",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "type": "object",
          "required": ["operations"],
          "properties": {
            "priority": {"$ref": "#/definitions/nonNegativeNumber"},
            "delay": {"$ref": "#/definitions/nonNegativeNumber"},
            "conditions": {
              "description": "",
              "type": "array",
              "items": {"$ref": "#/definitions/condition"}
            },
            "checkConditionInterval": {
              "description": "",
              "type": "object",
              "required": [
                "min",
                "max"
              ],
              "properties": {
                "min": {"$ref": "#/definitions/nonNegativeNumber"},
                "max": {"$ref": "#/definitions/nonNegativeNumber"}
              }
            },
            "operations": {
              "description": "",
              "type": "array",
              "minItems": 1,
              "items": {
                "description": "",
                "allOf": [
                  {"$ref": "#/definitions/annotation"},
                  {
                    "description": "",
                    "type": "object",
                    "required": ["target"],
                    "properties": {
                      "target": {
                        "oneOf": [
                          {
                            "type": "object",
                            "required": ["node"],
                            "properties": {
                              "node": {"$ref": "#/definitions/nodeProperty"}
                            }
                          },
                          {
                            "type": "object",
                            "required": ["edge"],
                            "properties": {
                              "edge": {"$ref": "#/definitions/edgeProperty"}
                            }
                          },
                          {"$ref": "#/definitions/globalVariableReference"}
                        ]
                      }
                    }
                  },
                  {
                    "description": "",
                    "type": "object",
                    "required": ["operator"],
                    "properties": {
                      "operator": {
                        "type": "string",
                        "enum": [
                          "=",
                          "*=",
                          "/=",
                          "+=",
                          "-="
                        ]
                      }
                    }
                  },
                  {"$ref": "#/definitions/value"}
                ]
              }
            }
          }
        }
      ]
    },
    "actions": {
      "$id": "#actions",
      "description": "A list of actions to be executed.",
      "type": "object",
      "required": ["actions"],
      "properties": {
        "actions": {
          "description": "",
          "type": "array",
          "minItems": 1,
          "items": {"$ref": "#/definitions/action"}
        }
      }
    },
    "sampling": {
      "$id": "#sampling",
      "description": "Sampling within a set with actions for sampled and non-sampled individuals.",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "oneOf": [
            {
              "$id": "#relativeSampling",
              "description": "",
              "type": "object",
              "required": [
                "type",
                "number"
              ],
              "minProperties": 3,
              "additionalProperties": false,
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "individual",
                    "group"
                  ]
                },
                "number": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 100
                },
                "sampled": {"$ref": "#/definitions/actionEnsemble"},
                "nonsampled": {"$ref": "#/definitions/actionEnsemble"}
              }
            },
            {
              "$id": "#absoluteSampling",
              "description": "",
              "type": "object",
              "required": [
                "type",
                "number"
              ],
              "minProperties": 3,
              "additionalProperties": false,
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["absolute"]
                },
                "number": {
                  "type": "number",
                  "minimum": 0,
                  "multipleOf": 1.0
                },
                "sampled": {"$ref": "#/definitions/actionEnsemble"},
                "nonsampled": {"$ref": "#/definitions/actionEnsemble"}
              }
            }
          ]
        }
      ]
    },
    "actionEnsemble": {
      "type": "object",
      "minProperties": 1,
      "properties": {
        "once": {
          "description": "A list of actions to be executed once.",
          "type": "array",
          "minItems": 1,
          "items": {"$ref": "#/definitions/action"}
        },
        "foreach": {
          "description": "A list of actions to be executed for each element in the filter.",
          "type": "array",
          "minItems": 1,
          "items": {"$ref": "#/definitions/action"}
        },
        "sampling": {"$ref": "#/definitions/sampling"}
      }
    },
    "edgeElementSelector": {
      "$id": "#edgeElementSelector",
      "description": "The specification of edge elements of a set.",
      "type": "object",
      "allOf": [
        {
          "required": ["elementType"],
          "properties": {
            "elementType": {
              "type": "string",
              "enum": ["edge"]
            }
          }
        },
        {
          "oneOf": [
            {
              "description": "",
              "type": "object",
              "required": [
                "operator",
                "left",
                "right"
              ],
              "properties": {
                "operator": {"$ref": "#/definitions/comparisonOperator"},
                "left": {
                  "type": "object",
                  "required": ["edge"],
                  "properties": {
                    "edge": {"$ref": "#/definitions/edgeProperty"}
                  }
                },
                "right": {"$ref": "#/definitions/value"}
              }
            },
            {
              "description": "",
              "type": "object",
              "required": [
                "operator",
                "left",
                "right"
              ],
              "properties": {
                "operator": {
                  "description": "",
                  "type": "string",
                  "enum": ["withPropertyIn"]
                },
                "left": {
                  "type": "object",
                  "required": ["edge"],
                  "properties": {
                    "edge": {"$ref": "#/definitions/edgeProperty"}
                  }
                },
                "right": {"$ref": "#/definitions/valueList"}
              }
            },
            {
              "description": "",
              "type": "object",
              "required": [
                "operator",
                "selector"
              ],
              "properties": {
                "operator": {
                  "description": "",
                  "type": "string",
                  "enum": [
                    "withTargetNodeIn",
                    "withSourceNodeIn"
                  ]
                },
                "selector": {"$ref": "#/definitions/setContent"}
              }
            }
          ]
        }
      ]
    },
    "nodeElementSelector": {
      "$id": "#nodeElementSelector",
      "description": "The specification of node elements of a set.",
      "type": "object",
      "oneOf": [
        {
          "required": [
            "elementType",
            "operator",
            "left",
            "right"
          ],
          "properties": {
            "elementType": {
              "type": "string",
              "enum": ["node"]
            },
            "operator": {"$ref": "#/definitions/comparisonOperator"},
            "left": {
              "type": "object",
              "required": ["node"],
              "properties": {
                "node": {"$ref": "#/definitions/nodeProperty"}
              }
            },
            "right": {"$ref": "#/definitions/value"}
          }
        },
        {
          "description": "",
          "required": [
            "elementType",
            "operator",
            "left",
            "right"
          ],
          "properties": {
            "elementType": {
              "type": "string",
              "enum": ["node"]
            },
            "operator": {
              "description": "",
              "type": "string",
              "enum": [
                "in",
                "not in"
              ]
            },
            "left": {
              "type": "object",
              "required": ["node"],
              "properties": {
                "node": {"$ref": "#/definitions/nodeProperty"}
              }
            },
            "right": {"$ref": "#/definitions/valueList"}
          }
        },
        {
          "description": "",
          "required": [
            "elementType",
            "operator",
            "left",
            "right"
          ],
          "properties": {
            "elementType": {
              "type": "string",
              "enum": ["node"]
            },
            "operator": {
              "description": "",
              "type": "string",
              "enum": ["withPropertyIn"]
            },
            "left": {
              "type": "object",
              "required": ["node"],
              "properties": {
                "node": {"$ref": "#/definitions/nodeProperty"}
              }
            },
            "right": {"$ref": "#/definitions/valueList"}
          }
        },
        {
          "description": "",
          "required": [
            "elementType",
            "operator",
            "selector"
          ],
          "properties": {
            "elementType": {
              "type": "string",
              "enum": ["node"]
            },
            "operator": {
              "description": "",
              "type": "string",
              "enum": ["withIncomingEdgeIn"]
            },
            "selector": {"$ref": "#/definitions/setContent"}
          }
        },
        {
          "description": "A filter selecting nodes from the external person trait database.",
          "oneOf": [
            {
              "description": "A table in the external person trait database.",
              "type": "object",
              "required": [
                "elementType",
                "table"
              ],
              "additionalProperties": false,
              "properties": {
                "elementType": {
                  "type": "string",
                  "enum": ["node"]
                },
                "table": {"$ref": "#/definitions/uniqueIdRef"}
              }
            },
            {
              "description": "A filter returining nodes if the result of comparing left and right values with the operator is true.",
              "required": [
                "elementType",
                "operator",
                "left",
                "right"
              ],
              "properties": {
                "elementType": {
                  "type": "string",
                  "enum": ["node"]
                },
                "operator": {"$ref": "#/definitions/comparisonOperator"},
                "left": {"$ref": "#/definitions/dbField"},
                "right": {
                  "type": "object",
                  "description": "",
                  "oneOf": [
                    {"$ref": "#/definitions/dbFieldValue"},
                    {"$ref": "#/definitions/observable"}
                  ]
                }
              }
            },
            {
              "description": "A filter returining nodes if the left field value is or is not in the right list.",
              "required": [
                "elementType",
                "operator",
                "left",
                "right"
              ],
              "properties": {
                "elementType": {
                  "type": "string",
                  "enum": ["node"]
                },
                "operator": {
                  "description": "",
                  "type": "string",
                  "enum": [
                    "in",
                    "not in"
                  ]
                },
                "left": {"$ref": "#/definitions/dbField"},
                "right": {
                  "type": "object",
                  "description": "",
                  "oneOf": [
                    {"$ref": "#/definitions/dbFieldValueList"},
                    {"$ref": "#/definitions/dbFieldValueSelector"}
                  ]
                }
              }
            }
          ]
        }
      ]
    },
    "setContent": {
      "$id": "#setContent",
      "description": "The specification of the content of a set.",
      "oneOf": [
        {"$ref": "#/definitions/edgeElementSelector"},
        {"$ref": "#/definitions/nodeElementSelector"},
        {"$ref": "#/definitions/dbFieldValueSelector"},
        {"$ref": "#/definitions/setOperation"},
        {"$ref": "#/definitions/setReference"},
        {
          "description": "Either all nodes or all edges",
          "type": "object",
          "required": ["elementType"],
          "properties": {
            "elementType": {
              "type": "string",
              "enum": [
                "node",
                "edge"
              ]
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "setReference": {
      "$id": "#setReference",
      "description": "A reference to a set.",
      "type": "object",
      "required": ["set"],
      "properties": {
        "set": {
          "type": "object",
          "required": ["idRef"],
          "properties": {
            "idRef": {"$ref": "#/definitions/uniqueIdRef"}
          }
        }
      }
    },
    "set": {
      "$id": "#set",
      "description": "A set of elements.",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "type": "object",
          "required": [
            "id",
            "content"
          ],
          "properties": {
            "id": {"$ref": "#/definitions/uniqueId"},
            "content": {"$ref": "#/definitions/setContent"}
          },
          "patternProperties": {
            "^ann:": {}
          },
          "additionalProperties": false
        }
      ]
    },
    "sets": {
      "$id": "#sets",
      "description": "A list of sets",
      "type": "array",
      "items": [
        {"$ref": "#/definitions/set"}
      ]
    },
    "selector": {
      "$id": "#selector",
      "description": "Selector for set content",
      "type": "object",
      "required": ["selector"],
      "properties": {
        "selector": {
          "allOf": [
            {"$ref": "#/definitions/annotation"},
            {"$ref": "#/definitions/setContent"}
          ]
        }
      }
    },
    "setOperation": {
      "$id": "#setOperation",
      "description": "An operation of multiple set which can be an intersection or a union.",
      "type": "object",
      "required": [
        "operation",
        "sets"
      ],
      "properties": {
        "operation": {
          "type": "string",
          "enum": [
            "union",
            "intersection"
          ]
        },
        "sets": {
          "type": "array",
          "items": {"$ref": "#/definitions/setContent"}
        }
      },
      "additionalProperties": false
    },
    "trigger": {
      "$id": "#trigger",
      "description": "A trigger evaluating to true or false.",
      "type": "object",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "required": ["trigger"],
          "properties": {
            "trigger": {"$ref": "#/definitions/boolean"},
            "interventionIds": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/uniqueIdRef"
              }
            }
          },
          "patternProperties": {
            "^ann:": {}
          },
          "additionalProperties": false
        }
      ]
    },
    "triggers": {
      "type": "array",
      "items": {"$ref": "#/definitions/trigger"}
    },
    "assignmentSet": {
      "$id": "#assignmentSet",
      "description": "A set of object with an associated action ensemble",
      "type": "object",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {"$ref": "#/definitions/selector"},
        {"$ref": "#/definitions/actionEnsemble"}
      ]
    },
    "initializations": {
      "$id": "#initializations",
      "description": "A list of initializations to be executed before the simulation starts.",
      "type": "array",
      "items": {"$ref": "#/definitions/assignmentSet"}
    },
    "intervention": {
      "$id": "#intervention",
      "description": "",
      "type": "object",
      "allOf": [
        {
          "type": "object",
          "required": ["id"],
          "properties": {
            "id": {"$ref": "#/definitions/uniqueId"}
          }
        },
        {"$ref": "#/definitions/assignmentSet"}
      ]
    },
    "interventions": {
      "$id": "#interventions",
      "description": "A list of interventions",
      "type": "array",
      "items": {"$ref": "#/definitions/intervention"}
    },
    "featureEnum": {
      "$id": "#featureEnum",
      "description": "An enumeration value allowed for a feature",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "description": "An enumeration value",
          "type": "object",
          "required": ["id"],
          "properties": {
            "id": {"$ref": "#/definitions/uniqueId"}
          },
          "patternProperties": {
            "^ann:": {}
          },
          "additionalProperties": false
        }
      ]
    },
    "featureEnums": {
      "$id": "#featureEnums",
      "description": "The enumeration values allowed for the feature",
      "type": "array",
      "items": {"$ref": "#/definitions/featureEnum"}
    },
    "traitFeature": {
      "$id": "#traitFeature",
      "description": "A feature of a trait",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "type": "object",
          "required": [
            "id",
            "enums",
            "default"
          ],
          "properties": {
            "id": {"$ref": "#/definitions/uniqueId"},
            "enums": {"$ref": "#/definitions/featureEnums"},
            "default": {"$ref": "#/definitions/uniqueIdRef"}
          },
          "patternProperties": {
            "^ann:": {}
          },
          "additionalProperties": false
        }
      ]
    },
    "traitFeatures": {
      "$id": "#traitFeatures",
      "description": "A list of features included in a trait",
      "type": "array",
      "items": {"$ref": "#/definitions/traitFeature"}
    },
    "trait": {
      "$id": "#trait",
      "description": "A trait.",
      "allOf": [
        {"$ref": "#/definitions/annotation"},
        {
          "description": "A trait",
          "type": "object",
          "required": [
            "id",
            "features"
          ],
          "properties": {
            "id": {"$ref": "#/definitions/uniqueId"},
            "features": {"$ref": "#/definitions/traitFeatures"}
          },
          "patternProperties": {
            "^ann:": {}
          },
          "additionalProperties": false
        }
      ]
    },
    "traits": {
      "$id": "#traits",
      "description": "The traits array.",
      "type": "array",
      "items": {"$ref": "#/definitions/trait"}
    },
    "personTraitDB": {"$ref": "./personTraitDB/schemas/dictionary.json#/definitions/tabularDataResource"},
    "personTraitDBs": {
      "type": "array",
      "items": {"$ref": "#/definitions/personTraitDB"}
    }
  }
}